{% extends "user/base.html" %}
{% load static %}

{% block title %}Pet Grooming Services{% endblock %}

{% block extra_css %}
<style>
/* ================= SERVICE CARD ================= */
.service-card{
  display:flex;
  align-items:center;
  gap:14px;
  padding:18px 20px;
  border-radius:16px;
  background:#ffffff;
  border:1px solid #e5e7eb;
  cursor:pointer;
  transition:.25s ease;
}

.service-card:hover{
  transform:translateY(-3px);
  box-shadow:0 14px 35px rgba(0,0,0,.08);
}

.service-card.active{
  border-color:#6366f1;
  box-shadow:0 18px 45px rgba(99,102,241,.25);
}

.service-card input{ display:none; }

/* ================= ICON ================= */
.service-icon{
  width:44px;
  height:44px;
  border-radius:50%;
  background:#eef2ff;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#6366f1;
  font-size:18px;
  flex-shrink:0;
}

/* ================= INPUT ================= */
.input{
  width:100%;
  padding:14px 16px;
  border-radius:14px;
  background:#f9fafb;
  border:1px solid #e5e7eb;
}

/* ================= GLASS ================= */
.glass{
  background:rgba(255,255,255,.9);
  backdrop-filter:blur(20px);
  border-radius:28px;
}
</style>
{% endblock %}

{% block content %}

<section class="max-w-5xl mx-auto px-6 py-16">

  <!-- HEADER -->
  <div class="text-center mb-14">
    <h1 class="text-4xl font-extrabold">
      Pet Grooming Services
    </h1>
    <p class="mt-3 text-gray-500">
      Luxury grooming designed for comfort & confidence.
    </p>
  </div>

  <form method="POST"
        action="{% url 'petapp:grooming' %}"
        class="glass p-12 space-y-12">

    {% csrf_token %}

    <!-- ================= SERVICES ================= -->
    <section>
      <h3 class="text-xl font-semibold mb-6">
        Select Services
      </h3>

      <div class="grid md:grid-cols-2 gap-6">
        {% for service in services %}
        <label class="service-card">

          <input type="checkbox"
                 name="services"
                 value="{{ service.id }}"
                 data-price="{{ service.price }}">

          <!-- ✅ ICON FROM ADMIN -->
          <div class="service-icon">
            <i class="fa-solid {{ service.icon|default:'fa-paw' }}"></i>
          </div>

          <div class="flex flex-col">
            <span class="font-medium">
              {{ service.name }}
            </span>
          </div>

          <span class="ml-auto font-semibold">
            ₹{{ service.price }}
          </span>

        </label>
        {% endfor %}
      </div>
    </section>

    <!-- ================= APPOINTMENT ================= -->
    <section>
      <h3 class="text-xl font-semibold mb-6">
        Appointment
      </h3>

      <div class="grid md:grid-cols-3 gap-6">
        <input type="date" name="date" class="input" required>
        <input type="time" name="time" class="input" required>
        <input type="tel"  name="phone" class="input"
               placeholder="Phone Number"
               pattern="[0-9]{10}" required>
      </div>
    </section>

    <!-- ================= TOTAL ================= -->
    <section class="flex justify-between items-center
                   p-6 rounded-2xl
                   bg-gradient-to-r from-indigo-600 to-pink-500
                   text-white">

      <div>
        <div class="text-sm opacity-80">Estimated Total</div>
        <div id="total" class="text-3xl font-extrabold">₹0</div>
      </div>

      <button type="submit"
              class="bg-white text-indigo-600
                     px-8 py-3 rounded-xl font-semibold">
        Book Grooming
      </button>

    </section>

  </form>
</section>

{% endblock %}

{% block extra_js %}
<script>
/* ================= TOTAL CALC ================= */
const totalEl = document.getElementById("total");

document.querySelectorAll(".service-card").forEach(card => {
  const checkbox = card.querySelector("input");

  card.addEventListener("click", () => {
    checkbox.checked = !checkbox.checked;
    card.classList.toggle("active", checkbox.checked);

    let total = 0;
    document.querySelectorAll("input[type=checkbox]:checked")
      .forEach(i => total += Number(i.dataset.price));

    totalEl.textContent = "₹" + total;
  });
});
</script>
{% endblock %}
