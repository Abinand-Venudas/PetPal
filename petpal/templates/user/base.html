{% load static %}
<!DOCTYPE html>
<html lang="en" class="">
<head>

<!-- üîß APPLY THEME BEFORE ANY PAINT -->
<script>
(function () {
  const saved = localStorage.getItem("theme");
  if (saved) {
    document.documentElement.classList.toggle("dark", saved === "dark");
  } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
    document.documentElement.classList.add("dark");
  }
})();
</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{% block title %}Pawfect{% endblock %}</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* üîí PREVENT WHITE FLASH */
html { background-color: #020617; }
body { background-color: inherit; }

/* Reset */
*{margin:0;padding:0;box-sizing:border-box}

html, body{
  width:100%;
  min-height:100%;
}

body{
  font-family:"Poppins",sans-serif;
  background:linear-gradient(180deg,#f7f8ff,#fff6fb);
  color:#111827;
  transition: background .6s ease, color .6s ease;
}

.preload * { transition: none !important; }

/* ================= DARK MODE ================= */
.dark body{
  background:#0f172a;
  color:#e5e7eb;
}

.dark p, .dark span, .dark h1, .dark h2, .dark h3,
.dark h4, .dark h5, .dark h6, .dark li{
  color:#e5e7eb;
}

/* ================= PAGE TRANSITIONS ================= */
.page-transition{
  opacity:0;
  transform:translateY(16px);
  transition:opacity .45s ease, transform .45s ease;
}
.page-transition.show{ opacity:1; transform:translateY(0); }
.page-transition.hide{ opacity:0; transform:translateY(24px); }

/* ================= GLASS NAV ================= */
.glass{
  background:rgba(255,255,255,.75);
  backdrop-filter:blur(14px);
  border-bottom:1px solid rgba(255,255,255,.4);
}
.dark .glass{
  background:rgba(15,23,42,.88);
  border-color:rgba(255,255,255,.08);
}

/* ================= NAV LINKS ================= */
.nav-link{
  position:relative;
  padding:10px 20px;
  border-radius:999px;
  font-weight:500;
  color:#374151;
  overflow:hidden;
  isolation:isolate;
  transition:color .25s ease, box-shadow .25s ease, transform .15s ease;
}
.nav-link span{ position:relative; z-index:2; }

.nav-link::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(120deg,#6366f1,#ec4899,#22d3ee);
  background-size:200% 200%;
  opacity:0;
  transition:opacity .35s ease;
  z-index:0;
  animation:gradientMove 6s linear infinite;
}
.nav-link::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  box-shadow:0 0 0 rgba(99,102,241,0);
  transition:box-shadow .35s ease;
  z-index:0;
}

.nav-link .underline{
  position:absolute;
  bottom:6px;
  left:50%;
  width:0;
  height:2px;
  background:linear-gradient(90deg,#6366f1,#ec4899);
  transform:translateX(-50%);
  transition:width .35s ease;
  z-index:1;
}

.nav-link .ripple{
  position:absolute;
  inset:0;
  border-radius:inherit;
  background:radial-gradient(circle at center, rgba(255,255,255,.35), transparent 60%);
  opacity:0;
  transform:scale(.4);
  transition:opacity .4s ease, transform .4s ease;
  z-index:0;
}

.nav-link:hover{ color:#fff; transform:translateY(-1px); }
.nav-link:hover::before{ opacity:1; }
.nav-link:hover::after{ box-shadow:0 10px 28px rgba(236,72,153,.45); }
.nav-link:hover .underline{ width:70%; }
.nav-link:hover .ripple{ opacity:1; transform:scale(1); }

.nav-link.active{
  color:#fff;
  background:linear-gradient(135deg,#6366f1,#ec4899);
  box-shadow:0 6px 18px rgba(236,72,153,.35);
}

.dark .nav-link{ color:#e5e7eb; }
.dark .nav-link::before{ background:linear-gradient(120deg,#4f46e5,#db2777,#22d3ee); }

/* ================= BUTTONS ================= */
.btn-login{
  padding:10px 22px;
  border-radius:999px;
  border:2px solid #6366f1;
  color:#6366f1;
  font-weight:600;
  background:#fff;
}
.btn-register{
  padding:10px 24px;
  border-radius:999px;
  background:linear-gradient(135deg,#6366f1,#ec4899);
  color:#fff;
  font-weight:600;
}
.dark .btn-login{
  background:#0f172a;
  color:#a5b4fc;
  border-color:#6366f1;
}

/* ================= DROPDOWN ================= */
.dropdown-menu{
  position:absolute;
  right:0;
  top:120%;
  width:230px;
  background:#fff;
  border-radius:14px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
  display:none;
  z-index:9999;
}
.dropdown-menu a{
  display:block;
  padding:12px 16px;
  font-size:14px;
  color:#374151;
}
.dropdown-menu a:hover{
  background:#f3f4ff;
  color:#6366f1;
}
.dark .dropdown-menu{ background:#1e293b; }
.dark .dropdown-menu a{ color:#e5e7eb; }
.dark .dropdown-menu a:hover{ background:#334155; color:#a5b4fc; }

/* ================= FOOTER ================= */
.footer-glass{
  background:rgba(255,255,255,.75);
  backdrop-filter:blur(16px);
  border-top:1px solid rgba(255,255,255,.45);
}
.dark .footer-glass{
  background:rgba(15,23,42,.88);
  border-color:rgba(255,255,255,.08);
}
.footer-link{
  color:#4b5563;
  font-size:14px;
  transition:.25s;
}
.footer-link:hover{ color:#6366f1; transform:translateX(4px); }
.footer-title{ font-weight:700; margin-bottom:14px; }
.dark .footer-link{ color:#cbd5e1; }
.dark .footer-link:hover{ color:#a5b4fc; }

/* ================= THEME TOGGLE ================= */
.theme-toggle{
  width:42px;
  height:42px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  background:linear-gradient(135deg,#6366f1,#ec4899);
  color:#fff;
  font-size:18px;
  transition:transform .4s ease, box-shadow .4s ease;
  box-shadow:0 6px 18px rgba(99,102,241,.45);
}
.theme-toggle:hover{
  transform:rotate(15deg) scale(1.05);
  box-shadow:0 12px 28px rgba(236,72,153,.55);
}
.theme-icon{ transition:transform .6s ease, opacity .4s ease; }
.rotate{ transform:rotate(360deg); }

/* ================= SOCIAL ICONS ================= */
.social-icons{
  display:flex;
  gap:14px;
  margin-top:14px;
}
.social-icons a{
  width:40px;
  height:40px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(135deg,#6366f1,#ec4899);
  color:white;
  font-size:16px;
  transition:.35s;
  box-shadow:0 6px 18px rgba(99,102,241,.35);
}
.social-icons a:hover{
  transform:translateY(-4px) scale(1.08);
  box-shadow:0 10px 28px rgba(236,72,153,.55);
}
.dark .social-icons a{
  background:linear-gradient(135deg,#4f46e5,#db2777);
}

@keyframes gradientMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
</style>

{% block extra_css %}{% endblock %}
</head>

<body class="preload flex flex-col min-h-screen">

<!-- ================= NAVBAR ================= -->
<!-- ================= NAVBAR ================= -->
<nav class="glass sticky top-0 z-50 px-16 py-5 flex justify-between items-center">

  <!-- LOGO -->
  <div class="text-3xl font-extrabold text-indigo-600">Pawfect</div>

  <!-- CENTER NAV LINKS -->
  <div class="flex gap-2 items-center">
    <a href="{% url 'petapp:home' %}" class="nav-link {% if request.path == '/' %}active{% endif %}">
      <span>Home</span><div class="underline"></div><div class="ripple"></div>
    </a>

    <a href="{% url 'petapp:grooming' %}" class="nav-link {% if 'grooming' in request.path %}active{% endif %}">
      <span>Grooming</span><div class="underline"></div><div class="ripple"></div>
    </a>

    <a href="{% url 'petapp:daycare' %}" class="nav-link {% if 'daycare' in request.path %}active{% endif %}">
      <span>Daycare</span><div class="underline"></div><div class="ripple"></div>
    </a>

    <a href="{% url 'petapp:consultation' %}" class="nav-link {% if 'consultation' in request.path %}active{% endif %}">
      <span>Consultation</span><div class="underline"></div><div class="ripple"></div>
    </a>

    <a href="{% url 'petapp:adoptionlist' %}" class="nav-link {% if 'adoption' in request.path %}active{% endif %}">
      <span>Adoption</span><div class="underline"></div><div class="ripple"></div>
    </a>
  </div>

  <!-- RIGHT AUTH + THEME -->
  <div class="flex gap-4 items-center relative">

    {% if request.session.user_id %}

    <!-- USER PROFILE DROPDOWN -->
    <div class="relative">
      <button
        class="flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-50 text-indigo-700 font-semibold hover:bg-indigo-100 transition"
        onclick="toggleDropdown('profileMenu')">
        <i class="fas fa-user-circle text-lg"></i>
        {{ request.session.username }} ‚ñæ
      </button>

      <div id="profileMenu" class="dropdown-menu">
        <a href="{% url 'petapp:profile' %}">üë§ My Profile</a>
        <a href="{% url 'petapp:edit_profile' %}">‚úèÔ∏è Edit Profile</a>
        <a href="{% url 'petapp:change_password' %}">üîí Change Password</a>
        <a href="{% url 'petapp:my_bookings' %}">üìÖ My Bookings</a>
        <hr class="my-2 border-gray-200">
        <a href="{% url 'petapp:logout' %}" class="text-red-500">üö™ Logout</a>
      </div>
    </div>

    {% else %}

    <!-- LOGIN DROPDOWN -->
    <div class="relative">
      <button class="btn-login" onclick="toggleDropdown('loginMenu')">Login ‚ñæ</button>
      <div id="loginMenu" class="dropdown-menu">
        <a href="{% url 'petapp:login' %}">üë§ User Login</a>
        <a href="{% url 'doctor:doctorLogin' %}">ü©∫ Doctor Login</a>
        <a href="{% url 'volunteer:volunteerLogin' %}">ü§ù Volunteer Login</a>
        <a href="{% url 'petadmin:loginAdmin' %}">üõ° Admin Login</a>
      </div>
    </div>

    <!-- REGISTER DROPDOWN -->
    <div class="relative">
      <button class="btn-register" onclick="toggleDropdown('registerMenu')">Register ‚ñæ</button>
      <div id="registerMenu" class="dropdown-menu">
        <a href="{% url 'petapp:register' %}">üë§ User Register</a>
        <a href="{% url 'doctor:doctorSignup' %}">ü©∫ Doctor Register</a>
        <a href="{% url 'volunteer:volunteerSignup' %}">ü§ù Volunteer Register</a>
      </div>
    </div>

    {% endif %}

    <!-- üåô / ‚òÄ DARK MODE TOGGLE -->
    <div class="theme-toggle" onclick="toggleTheme()">
      <i id="themeIcon" class="fas fa-moon theme-icon"></i>
    </div>

  </div>
</nav>


<!-- ================= PAGE CONTENT ================= -->
<main class="flex-grow page-transition" id="pageTransition">
  {% block content %}{% endblock %}
</main>

<!-- ================= FOOTER ================= -->
<footer class="footer-glass px-16 py-16 mt-16">
  <div class="grid md:grid-cols-4 gap-12">

    <div>
      <h2 class="text-3xl font-extrabold text-indigo-600 mb-4">Pawfect</h2>
      <p class="text-sm footer-link">Your trusted pet-care platform üêæ</p>
      <div class="social-icons mt-4">
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-x-twitter"></i></a>
        <a href="#"><i class="fab fa-linkedin-in"></i></a>
        <a href="#"><i class="fab fa-youtube"></i></a>
      </div>
    </div>

    <div>
      <h3 class="footer-title">Quick Links</h3>
      <a href="{% url 'petapp:home' %}" class="footer-link block">Home</a>
      <a href="{% url 'petapp:grooming' %}" class="footer-link block">Grooming</a>
      <a href="{% url 'petapp:daycare' %}" class="footer-link block">Daycare</a>
      <a href="{% url 'petapp:consultation' %}" class="footer-link block">Consultation</a>
      <a href="{% url 'petapp:adoptionlist' %}" class="footer-link block">Adoption</a>
    </div>

    <div>
      <h3 class="footer-title">Services</h3>
      <p class="footer-link">Pet Grooming</p>
      <p class="footer-link">Pet Daycare</p>
      <p class="footer-link">Vet Consultation</p>
      <p class="footer-link">Pet Adoption</p>
    </div>

    <div>
      <h3 class="footer-title">Contact</h3>
      <p class="footer-link">üìç India</p>
      <p class="footer-link">üìß support@pawfect.com</p>
      <p class="footer-link">üìû +91 9XXXXXXXXX</p>
      <p class="footer-link">‚è∞ 10AM ‚Äì 10PM</p>
    </div>
  </div>

  <div class="mt-12 text-center text-sm footer-link">
    ¬© {{ now|date:"Y" }} Pawfect. All rights reserved.
  </div>
</footer>

<!-- ================= JS ================= -->
<script>
window.addEventListener("load", () => {
  document.body.classList.remove("preload");
  document.getElementById("pageTransition").classList.add("show");
});

/* ================= DARK MODE ================= */
const root = document.documentElement;
const icon = document.getElementById("themeIcon");

function setTheme(theme){
  if(theme === "dark"){
    root.classList.add("dark");
    icon.classList.replace("fa-moon","fa-sun");
  }else{
    root.classList.remove("dark");
    icon.classList.replace("fa-sun","fa-moon");
  }
}

const savedTheme = localStorage.getItem("theme");
if(savedTheme){
  setTheme(savedTheme);
}else if(window.matchMedia("(prefers-color-scheme: dark)").matches){
  setTheme("dark");
}else{
  setTheme("light");
}

function toggleTheme(){
  icon.classList.add("rotate");
  setTimeout(()=>{ icon.classList.remove("rotate"); },500);
  const isDark = root.classList.contains("dark");
  const newTheme = isDark ? "light" : "dark";
  setTheme(newTheme);
  localStorage.setItem("theme", newTheme);
}
</script>

<script>
/* ================= DROPDOWNS ================= */
function toggleDropdown(id){
  document.querySelectorAll(".dropdown-menu").forEach(m=>{
    if(m.id !== id) m.style.display="none";
  });
  const menu = document.getElementById(id);
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}

document.addEventListener("click", e=>{
  if(!e.target.closest(".relative")){
    document.querySelectorAll(".dropdown-menu").forEach(m=>m.style.display="none");
  }
});
</script>


{% block extra_js %}{% endblock %}
</body>
</html>
