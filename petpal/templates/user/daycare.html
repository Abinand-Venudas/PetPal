{% extends "user/base.html" %}
{% load static %}

{% block title %}PetPal ‚Äî Daycare{% endblock %}

{% block extra_css %}
<style>
/* =========================================================
   THEME VARIABLES
========================================================= */
:root{
  --pink:#ec4899;
  --purple:#8b5cf6;

  --bg-light:#f8fafc;
  --bg-dark:#020617;

  --card-light:#ffffff;
  --card-dark:#0b1220;

  --text-light:#0f172a;
  --text-dark:#e5e7eb;

  --muted-light:#475569;
  --muted-dark:#94a3b8;

  --border-light:#e5e7eb;
  --border-dark:rgba(255,255,255,.15);
}

/* =========================================================
   GLOBAL
========================================================= */
body{
  background:var(--bg-light);
  color:var(--text-light);
}
body.dark{
  background:var(--bg-dark);
  color:var(--text-dark);
}

/* =========================================================
   HERO
========================================================= */
.hero-overlay{
  background:
    radial-gradient(circle at 30% 30%, rgba(236,72,153,.25), transparent 40%),
    radial-gradient(circle at 70% 60%, rgba(139,92,246,.25), transparent 40%),
    linear-gradient(to bottom, rgba(0,0,0,.65), rgba(0,0,0,.65));
}
.hero-content{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  z-index:5;
}
.hero-card{
  padding:70px 80px;
  border-radius:40px;
  background:rgba(255,255,255,.12);
  backdrop-filter:blur(25px);
  border:1px solid rgba(255,255,255,.18);
}
.hero-title{
  font-size:3.2rem;
  font-weight:900;
  background:linear-gradient(90deg,#fff,#fde2f3,#e0e7ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.hero-sub{
  color:#e5e7eb;
  margin-top:24px;
}

/* =========================================================
   CARD
========================================================= */
.card{
  background:var(--card-light);
  color:var(--text-light);
  border-radius:28px;
  border:1px solid var(--border-light);
  box-shadow:0 40px 90px rgba(0,0,0,.12);
}
body.dark .card{
  background:var(--card-dark);
  color:var(--text-dark);
  border:1px solid var(--border-dark);
  box-shadow:0 40px 90px rgba(0,0,0,.9);
}

.card h1,.card h2,.card h3,.card h4{
  font-weight:800;
}

/* =========================================================
   MUTED TEXT (NO OPACITY ‚Äì SAFE)
========================================================= */
.muted{
  color:var(--muted-light);
}
body.dark .muted{
  color:var(--muted-dark);
}

/* =========================================================
   INPUTS
========================================================= */
.input{
  width:100%;
  padding:18px 20px;
  border-radius:18px;
  border:1.5px solid var(--border-light);
  background:#ffffff;
  color:var(--text-light);
}
body.dark .input{
  background:#020617;
  border-color:var(--border-dark);
  color:var(--text-dark);
}
body.dark .input::placeholder{
  color:var(--muted-dark);
}

/* =========================================================
   PLANS
========================================================= */
.plan-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:26px;
}
.plan-card{
  padding:34px;
  border-radius:26px;
  border:2px solid transparent;
  cursor:pointer;
  transition:.25s;
}
.plan-card:hover{
  transform:translateY(-3px);
}
.plan-card.active{
  border-color:var(--pink);
  box-shadow:0 30px 70px rgba(236,72,153,.35);
}
.plan-price{
  font-size:2rem;
  font-weight:900;
  margin-top:12px;
  background:linear-gradient(90deg,var(--pink),var(--purple));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* =========================================================
   TIME SLOTS
========================================================= */
.time-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
  gap:14px;
}
.time-btn{
  padding:12px 0;
  border-radius:14px;
  font-weight:700;
  background:#f1f5f9;
  border:1.5px solid #94a3b8;
  color:#020617;
}
.time-btn:hover{
  background:#e2e8f0;
}
.time-btn.active{
  background:linear-gradient(135deg,var(--pink),var(--purple));
  color:#ffffff;
  border:none;
}
body.dark .time-btn{
  background:#111827;
  border-color:#475569;
  color:var(--text-dark);
}
body.dark .time-btn:hover{
  background:#1f2937;
}

/* =========================================================
   SUMMARY
========================================================= */
.summary{
  background:linear-gradient(135deg,#fff1f8,#eef2ff);
  border-radius:32px;
  padding:36px;
  box-shadow:0 40px 100px rgba(0,0,0,.15);
}
body.dark .summary{
  background:#0b1220;
  border:1px solid var(--border-dark);
}
.total{
  font-size:2rem;
  font-weight:900;
  background:linear-gradient(90deg,var(--pink),var(--purple));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* ================= THEME VARIABLES ================= */
:root{
  --pink:#ec4899;
  --purple:#8b5cf6;

  --bg-light:#f8fafc;
  --bg-dark:#020617;

  --card-light:#ffffff;
  --card-dark:#0b1220;

  --text-light:#0f172a;
  --text-dark:#e5e7eb;

  --muted-light:#475569;
  --muted-dark:#cbd5f5;
}

/* ================= GLOBAL ================= */
body{
  background:var(--bg-light);
  color:var(--text-light);
}
body.dark{
  background:var(--bg-dark);
  color:var(--text-dark);
}

/* ================= CARD BASE ================= */
.card{
  background:var(--card-light);
  color:var(--text-light);
  border-radius:28px;
  box-shadow:0 40px 90px rgba(0,0,0,.12);
}
body.dark .card{
  background:var(--card-dark);
  color:var(--text-dark);
  box-shadow:0 40px 90px rgba(0,0,0,.9);
}

/* ================= PLAN CARDS (FIXED) ================= */
.plan-card{
  padding:34px;
  border-radius:26px;
  border:2px solid transparent;
  cursor:pointer;
  transition:.25s;
}

.plan-card:hover{
  transform:translateY(-3px);
}

.plan-card.active{
  border-color:var(--pink);
  box-shadow:0 30px 70px rgba(236,72,153,.35);
}

/* üî¥ LIGHT MODE TEXT */
.plan-card h4{
  color:var(--text-light);
}
.plan-card p{
  color:var(--muted-light);
}

/* üî• DARK MODE ‚Äî HARD RESET (THIS IS THE FIX) */
body.dark .plan-card *{
  opacity:1 !important;           /* kill Tailwind opacity */
}

body.dark .plan-card h4{
  color:#ffffff !important;
}

body.dark .plan-card p{
  color:#cbd5e1 !important;       /* readable muted text */
}

body.dark .plan-card small{
  color:#cbd5e1 !important;
}

/* Price gradient (safe) */
.plan-price{
  font-size:2rem;
  font-weight:900;
  margin-top:12px;
  background:linear-gradient(90deg,var(--pink),var(--purple));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* ================= TIME BUTTONS ================= */
.time-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
  gap:14px;
}
.time-btn{
  padding:12px 0;
  border-radius:14px;
  font-weight:700;
  background:#f1f5f9;
  border:1.5px solid #94a3b8;
  color:#020617;
}
.time-btn.active{
  background:linear-gradient(135deg,var(--pink),var(--purple));
  color:#fff;
}
body.dark .time-btn{
  background:#111827;
  border-color:#475569;
  color:#e5e7eb;
}

/* ================= SUMMARY ================= */
.summary{
  background:linear-gradient(135deg,#fff1f8,#eef2ff);
  border-radius:32px;
  padding:36px;
}
body.dark .summary{
  background:#0b1220;
}

.summary *{
  opacity:1 !important;
}
/* =========================================================
   üî• FINAL FIX ‚Äî SECTION HEADINGS VISIBILITY ONLY
   (No side effects, no removals)
========================================================= */

/* 1Ô∏è‚É£ Headings inside cards must always be dark on light cards */
.card h3{
  color: var(--text-light);
}

/* 2Ô∏è‚É£ Dark mode: still keep card headings dark (cards are light) */
body.dark .card h3{
  color: #0f172a !important;
}

/* 3Ô∏è‚É£ Summary heading (plan name) */
.summary h3{
  color: var(--text-light);
}

body.dark .summary h3{
  color: #0f172a !important;
}
/* 4Ô∏è‚É£ Summary duration text */
.summary .muted{
  color: var(--muted-light);
}
</style>


{% endblock %}

{% block content %}

<!-- HERO -->
<section class="relative h-[80vh] overflow-hidden">
  <video autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover">
    <source src="{% static 'img/daycare.mp4' %}" type="video/mp4">
  </video>
  <div class="absolute inset-0 hero-overlay"></div>
  <div class="hero-content">
    <div class="hero-card">
      <h1 class="hero-title">Where Your Pet‚Äôs Day Feels Like Home</h1>
      <p class="hero-sub">Flexible daycare for short stays and long trips</p>
    </div>
  </div>
</section>

<section class="max-w-7xl mx-auto px-6 mt-32">
<form method="POST" id="daycareForm">
{% csrf_token %}

<!-- PLANS -->
<div class="card p-14 max-w-6xl mx-auto">
  <h3 class="text-4xl font-extrabold mb-12 text-center">Choose a Plan</h3>

  <div class="plan-grid">
    {% for plan in plans %}
    <div class="card plan-card"
         data-name="{{ plan.name }}"
         data-price="{{ plan.price_per_hour }}"
         data-maxdays="{{ plan.max_days }}">

      <h4 class="text-2xl font-bold">{{ plan.name }}</h4>
      <p class="muted mt-2">{{ plan.description }}</p>
      <div class="plan-price">‚Çπ{{ plan.price_per_hour }} / hour</div>
      <p class="text-xs muted mt-2">Up to {{ plan.max_days }} days</p>

    </div>
    {% endfor %}
  </div>
</div>

<!-- DETAILS -->
<div class="card p-14 max-w-5xl mx-auto mt-28">
  <h3 class="text-4xl font-extrabold mb-12 text-center">Booking Details</h3>

  <div class="grid md:grid-cols-2 gap-8">
    <input class="input" name="pet_name" placeholder="Pet name" required>
    <input class="input" name="owner_name" placeholder="Owner name" required>
    <input class="input" name="phone" placeholder="Phone" required>
    <input class="input md:col-span-2" type="date" name="date" required>

    <label class="md:col-span-2 font-semibold">Number of Days</label>
    <input class="input md:col-span-2" id="days" name="days" type="number" min="1" value="1">
  </div>

  <div class="mt-12">
    <label class="font-semibold mb-4 block">Drop-off Time</label>
    <div class="time-grid" id="timeGrid"></div>
  </div>
</div>

<!-- SUMMARY -->
<div class="summary max-w-xl mx-auto mt-20 text-center">
  <h3 id="planName" class="font-bold text-xl"></h3>
  <p id="durationName" class="muted"></p>
  <div class="total">‚Çπ<span id="total">0</span></div>

  <input type="hidden" name="plan" id="plan_input">
  <input type="hidden" name="total_cost" id="total_cost_input">
  <input type="hidden" name="start_time" id="start_time">

  <button class="mt-6 w-full py-5 rounded-2xl text-white font-bold"
          style="background:linear-gradient(135deg,var(--pink),var(--purple));">
    Confirm Booking
  </button>
</div>

</form>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded",()=>{

const plans=document.querySelectorAll(".plan-card");
const daysInput=document.getElementById("days");
const planName=document.getElementById("planName");
const durationName=document.getElementById("durationName");
const totalEl=document.getElementById("total");
const planInput=document.getElementById("plan_input");
const totalInput=document.getElementById("total_cost_input");
const timeGrid=document.getElementById("timeGrid");
const startInput=document.getElementById("start_time");

let selected=null;

function update(){
  if(!selected) return;
  const price=+selected.dataset.price;
  const days=Math.max(1,+daysInput.value);
  const hours=days*24;
  const total=price*hours;

  planName.innerText=selected.dataset.name;
  durationName.innerText=`${days} day(s) ‚Ä¢ ${hours} hrs`;
  totalEl.innerText=total.toFixed(2);

  planInput.value=selected.dataset.name;
  totalInput.value=total.toFixed(2);
}

plans.forEach(p=>{
  p.onclick=()=>{
    plans.forEach(x=>x.classList.remove("active"));
    p.classList.add("active");
    selected=p;
    daysInput.max=p.dataset.maxdays;
    update();
  };
});

if(plans.length) plans[0].click();
daysInput.oninput=update;

/* Time slots */
for(let h=10;h<=22;h++){
  const t=`${String(h).padStart(2,"0")}:00`;
  const b=document.createElement("button");
  b.type="button";
  b.className="time-btn";
  b.innerText=t;
  b.onclick=()=>{
    document.querySelectorAll(".time-btn").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    startInput.value=t;
  };
  timeGrid.appendChild(b);
}

});
</script>
{% endblock %}
