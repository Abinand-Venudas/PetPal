{% extends "petadmin/baseAdmin.html" %}
{% load static %}

{% block title %}Doctor Availability{% endblock %}

{% block content %}

<h1 class="text-4xl font-extrabold mb-6">Doctor Availability</h1>
<p class="text-gray-500 mb-10">
  Live availability based on doctor check-in / check-out (Admin Override Enabled)
</p>

<!-- SORTING -->
<form method="get" class="mb-10 flex flex-wrap gap-4">
  <select
    name="sort"
    class="px-4 py-3 rounded-xl border w-full md:w-72"
    onchange="this.form.submit()"
  >
    <option value="">Sort Doctors</option>
    <option value="name" {% if sort == "name" %}selected{% endif %}>Name (A‚ÄìZ)</option>
    <option value="city" {% if sort == "city" %}selected{% endif %}>City</option>
    <option value="specialization" {% if sort == "specialization" %}selected{% endif %}>
      Specialization
    </option>
    <option value="available" {% if sort == "available" %}selected{% endif %}>
      Availability
    </option>
  </select>
</form>

<!-- DOCTORS GRID -->
<div class="grid md:grid-cols-3 gap-6">

{% for doctor in doctors %}
<div class="bg-white p-6 rounded-2xl shadow relative">

  <!-- STATUS BADGE -->
  {% if doctor.is_available %}
    <span class="absolute top-4 right-4 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700">
      Online
    </span>
  {% else %}
    <span class="absolute top-4 right-4 px-3 py-1 rounded-full text-xs font-semibold bg-gray-200 text-gray-700">
      Offline
    </span>
  {% endif %}

  <!-- PROFILE -->
  <div class="flex items-center gap-4 mb-4">
    {% if doctor.image %}
      <img src="{{ doctor.image.url }}" class="w-14 h-14 rounded-full object-cover">
    {% else %}
      <img src="{% static 'img/default-doctor.png' %}" class="w-14 h-14 rounded-full">
    {% endif %}

    <div>
      <h3 class="font-semibold text-lg">Dr. {{ doctor.name }}</h3>
      <p class="text-sm text-gray-500">{{ doctor.specialization }}</p>
    </div>
  </div>

  <!-- DETAILS -->
  <p class="text-sm text-gray-600 mb-5">
    üè• {{ doctor.clinic }} <br>
    üìç {{ doctor.city }}
  </p>

  <!-- FORCE ONLINE / OFFLINE -->
  <div class="flex gap-2 mb-4">
    <a href="{% url 'petadmin:forceDoctorOnline' doctor.id %}"
       class="flex-1 text-center py-2 rounded-xl text-sm font-semibold
       bg-green-100 text-green-700 hover:bg-green-200">
      Force Online
    </a>

    <a href="{% url 'petadmin:forceDoctorOffline' doctor.id %}"
       class="flex-1 text-center py-2 rounded-xl text-sm font-semibold
       bg-gray-200 text-gray-700 hover:bg-gray-300">
      Force Offline
    </a>
  </div>

  <!-- ACTIONS -->
  <div class="flex gap-3">
    <a href="{% url 'petadmin:doctorDetailsAdmin' doctor.id %}"
       class="flex-1 text-center py-2 rounded-xl bg-indigo-100 text-indigo-700 font-medium">
      View Profile
    </a>

    <a href="{% url 'petadmin:deleteDoctor' doctor.id %}"
       onclick="return confirm('Are you sure you want to remove this doctor?')"
       class="flex-1 text-center py-2 rounded-xl bg-red-100 text-red-700 font-medium">
      Remove
    </a>
  </div>

</div>
{% endfor %}

</div>

{% endblock %}
