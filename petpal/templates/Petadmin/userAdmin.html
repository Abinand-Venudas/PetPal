{% extends "petadmin/baseadmin.html" %}

{% block content %}
<div class="p-10">

  <!-- PAGE HEADER -->
  <div class="mb-8">
    <h1 class="text-4xl font-extrabold text-slate-900">Registered Users</h1>
    <p class="text-slate-500 mt-1">
      Manage platform users and view adoption activity
    </p>
  </div>

  <!-- USERS TABLE -->
  <div class="bg-white rounded-2xl shadow overflow-hidden">
    <table class="w-full text-sm">
      <thead class="bg-gray-100 text-slate-700">
        <tr>
          <th class="p-4 text-left">Name</th>
          <th class="p-4 text-left">Email</th>
          <th class="p-4 text-left">Status</th>
          <th class="p-4 text-left">Adoptions</th>
          <th class="p-4 text-left">Actions</th>
        </tr>
      </thead>

      <tbody>
        {% for user in users %}
        <tr class="border-b hover:bg-gray-50 transition">

          <!-- NAME -->
          <td class="p-4 font-medium text-slate-900">
            {{ user.name }}
          </td>

          <!-- EMAIL -->
          <td class="p-4 text-slate-600">
            {{ user.email }}
          </td>

          <!-- STATUS -->
          <td class="p-4">
            {% if user.is_active %}
              <span class="px-3 py-1 rounded-full text-xs font-semibold
                           bg-green-100 text-green-700">
                Active
              </span>
            {% else %}
              <span class="px-3 py-1 rounded-full text-xs font-semibold
                           bg-red-100 text-red-700">
                Blocked
              </span>
            {% endif %}
          </td>

          <!-- ðŸ¾ ADOPTIONS (ALWAYS VIEWABLE) -->
          <td class="p-4">
            <a href="{% url 'petadmin:adminAdoptions' %}?user={{ user.id }}"
               class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full
               {% if user.adoption_count > 0 %}
                 bg-indigo-100 text-indigo-700 hover:bg-indigo-200
               {% else %}
                 bg-gray-100 text-gray-600 hover:bg-gray-200
               {% endif %}
               font-semibold transition">

              ðŸ¾
              {% if user.adoption_count > 0 %}
                {{ user.adoption_count }}
              {% else %}
                View
              {% endif %}
            </a>
          </td>

          <!-- ACTIONS -->
          <td class="p-4 flex gap-2">

            <!-- VIEW -->
            <a href="{% url 'petadmin:userDetailsAdmin' user.id %}"
               class="px-4 py-2 rounded-lg text-blue-700 bg-blue-100
                      hover:bg-blue-200 transition font-medium">
              View
            </a>

            <!-- BLOCK / UNBLOCK -->
            <a href="{% url 'petadmin:toggleUserStatus' user.id %}"
               class="px-4 py-2 rounded-lg font-medium transition
               {% if user.is_active %}
                 bg-yellow-100 text-yellow-700 hover:bg-yellow-200
               {% else %}
                 bg-green-100 text-green-700 hover:bg-green-200
               {% endif %}">
              {% if user.is_active %}Block{% else %}Unblock{% endif %}
            </a>

            <!-- DELETE -->
            <a href="{% url 'petadmin:deleteUser' user.id %}"
               onclick="return confirm('Are you sure you want to permanently delete this user?')"
               class="px-4 py-2 rounded-lg text-red-700 bg-red-100
                      hover:bg-red-200 transition font-medium">
              Delete
            </a>

          </td>
        </tr>

        {% empty %}
        <tr>
          <td colspan="5" class="p-6 text-center text-gray-500">
            No users found
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
